import{k as V,r as A,c as E,a as l,o as i,F as Q,p as T,b as e,f as w,t as y,n as j,w as D,q as F,l as L,j as N,d as q,g as u,e as S,i as H}from"./index-Czo4c4ru.js";import{u as O,_ as U,a as G,b as J}from"./playlist-D6YYoHEQ.js";import{usePlayerStore as R}from"./player-BX6ui6XM.js";import{getSongImage as B,getSongTitle as K,getSongArtist as W}from"./songHelpers-TQLMU_GJ.js";const X={class:"space-y-1"},Y=["onClick"],Z={class:"w-10 h-10 bg-vibrant-pink-light pixel-border border-vibrant-pink flex items-center justify-center flex-shrink-0 relative overflow-hidden"},ee=["src","alt","data-song-id"],te={key:0,class:"absolute inset-0 bg-vibrant-pink bg-opacity-40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"},se={class:"text-white text-sm font-semibold"},oe={key:1,class:"absolute inset-0 bg-vibrant-pink bg-opacity-40 flex items-center justify-center"},ne={key:2,class:"absolute inset-0 pixel-border border-vibrant-pink"},re={class:"flex-1 min-w-0"},ae={class:"text-gray-600 text-xs truncate"},ie={class:"flex items-center space-x-4"},le=["onClick","disabled","title"],ce=["onClick"],de={__name:"SongList",props:{songs:{type:Array,default:()=>[]},songData:{type:Object,default:()=>({})},showRemove:{type:Boolean,default:!1}},emits:["play","remove"],setup(I,{emit:h}){const p=I,a=h,k=R(),v=V(),x=A(new Set),c=A(!1),b=A(null),$=E(()=>!v||!Array.isArray(v.songs)?new Set:new Set(v.songs.map(t=>t==null?void 0:t.id).filter(Boolean))),_=t=>{var s;return((s=k.currentSong)==null?void 0:s.id)===t.songId&&k.isPlaying},P=t=>{const s=p.songData[t.songId];return K(s)},C=t=>{const s=p.songData[t.songId];return W(s)},r=t=>{const s=p.songData[t.songId];return x.value.has(t.songId)?B(null):B(s)},o=t=>{const s=t.target.dataset.songId;s&&(x.value.add(s),t.target.src=B(null))},d=t=>{const s=p.songData[t.songId];s&&a("play",s)},f=t=>{if(!(t!=null&&t.songId))return!1;const s=String(t.songId);return Array.from($.value).map(g=>String(g)).includes(s)},M=async t=>{if(c.value){console.log("Already adding a song, please wait");return}if(!(t!=null&&t.songId)){console.error("Invalid playlist song:",t);return}if(f(t)){console.log("Song already in queue, skipping add");return}const s=t.songId,n=p.songData[s],g=(n==null?void 0:n.id)||s;if(b.value===g){console.log("This song is already being added");return}c.value=!0,b.value=g;try{console.log("Adding single song to queue:",g,(n==null?void 0:n.title)||"Unknown");const m=await v.addSongToQueue(g,0);m.success?console.log("Song added to queue successfully:",g):console.error("Failed to add song to queue:",m.error)}catch(m){console.error("Error adding song to queue:",m)}finally{c.value=!1,b.value=null}},z=t=>{a("remove",t)};return(t,s)=>(i(),l("div",X,[(i(!0),l(Q,null,T(I.songs,(n,g)=>(i(),l("div",{key:n.songId,class:"flex items-center space-x-4 px-4 py-2 pixel-texture hover:bg-vibrant-bg-hover group cursor-pointer transition-colors",onClick:m=>d(n)},[e("div",Z,[e("img",{src:r(n),alt:P(n),"data-song-id":n.songId,class:"w-full h-full object-cover pixelated",onError:o},null,40,ee),_(n)?w("",!0):(i(),l("div",te,[e("span",se,y(g+1),1)])),_(n)?(i(),l("div",oe,[...s[0]||(s[0]=[e("svg",{class:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)])])):w("",!0),_(n)?(i(),l("div",ne)):w("",!0)]),e("div",re,[e("p",{class:j(["text-gray-900 font-medium text-sm truncate",{"text-vibrant-pink":_(n)}])},y(P(n)),3),e("p",ae,y(C(n)),1)]),e("div",ie,[e("button",{onClick:D(m=>M(n),["stop","prevent"]),disabled:f(n)||c.value,class:j(["transition-opacity",f(n)||c.value?"opacity-0 group-hover:opacity-40 text-gray-500 cursor-not-allowed pointer-events-none":"opacity-70 group-hover:opacity-100 text-vibrant-purple hover:text-vibrant-pink cursor-pointer"]),title:f(n)?"Already in queue":c.value?"Adding...":"Add to queue",type:"button"},[...s[1]||(s[1]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)])],10,le),I.showRemove?(i(),l("button",{key:0,onClick:D(m=>z(n),["stop"]),class:"text-vibrant-purple hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Remove from playlist"},[...s[2]||(s[2]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ce)):w("",!0)])],8,Y))),128))]))}},ue={class:"flex h-screen"},ge={class:"flex-1 flex flex-col overflow-hidden"},ve={class:"flex-1 overflow-y-auto pb-24"},pe={key:0,class:"flex items-center justify-center h-full"},fe={key:1,class:"p-8"},me={class:"bg-red-100 pixel-border border-red-500 p-4 text-red-700 pixel-texture"},ye={key:2,class:"relative"},he={class:"bg-gradient-to-b from-vibrant-purple to-vibrant-bg px-8 pt-16 pb-8"},xe={class:"flex items-end space-x-6"},be={class:"flex-1 min-w-0"},_e={class:"text-5xl font-bold text-gray-900 mb-4 truncate"},we={key:0,class:"text-gray-700 mb-4"},ke={class:"flex items-center space-x-4"},Ie={class:"text-gray-700 text-sm"},Pe={class:"px-8 py-4"},Ae={key:0,class:"text-center py-12"},Be={__name:"PlaylistDetailView",setup(I){const h=N(),p=H(),a=O(),k=R(),v=V(),x=A({});F(async()=>{await c(),await b()}),L(()=>h.params.id,async()=>{await c(),await b()});const c=async()=>{const r=h.params.id;r&&await a.fetchPlaylist(r)},b=async()=>{var o;await v.fetchQueue();const r={};v.songs.forEach(d=>{r[d.id]=d}),(o=a.currentPlaylist)!=null&&o.songs&&a.currentPlaylist.songs.forEach(d=>{const f=v.songs.find(M=>M.id===d.songId);f&&(r[d.songId]=f)}),x.value=r},$=()=>{var r;if((r=a.currentPlaylist)!=null&&r.songs){const o=a.currentPlaylist.songs.map(d=>x.value[d.songId]).filter(Boolean);o.length>0&&k.setQueue(o,0)}},_=r=>{r&&r.id&&k.play(r)},P=async r=>{const o=h.params.id;o&&(await a.removeSongFromPlaylist(o,r.songId)).success&&await c()},C=async()=>{if(confirm("Are you sure you want to delete this playlist?")){const r=h.params.id;r&&(await a.deletePlaylist(r)).success&&p.push("/playlists")}};return(r,o)=>(i(),l("div",ue,[q(U),e("div",ge,[q(G),e("div",ve,[u(a).loading?(i(),l("div",pe,[...o[0]||(o[0]=[e("p",{class:"text-gray-600"},"Loading playlist...",-1)])])):u(a).error?(i(),l("div",fe,[e("div",me,y(u(a).error),1)])):u(a).currentPlaylist?(i(),l("div",ye,[e("div",he,[e("div",xe,[o[2]||(o[2]=e("div",{class:"w-48 h-48 bg-gradient-to-br from-vibrant-pink to-vibrant-orange rounded-md flex items-center justify-center flex-shrink-0 shadow-2xl"},[e("svg",{class:"w-24 h-24 text-white opacity-80",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M18 3a1 1 0 00-1.196-.98l-10 2A1 1 0 006 5v9.114A4.369 4.369 0 005 14c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V7.82l8-1.6v5.894A4.37 4.37 0 0015 12c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V3z"})])],-1)),e("div",be,[o[1]||(o[1]=e("p",{class:"text-sm font-semibold text-gray-900 uppercase mb-2"},"Playlist",-1)),e("h1",_e,y(u(a).currentPlaylist.playlist.name),1),u(a).currentPlaylist.playlist.description?(i(),l("p",we,y(u(a).currentPlaylist.playlist.description),1)):w("",!0),e("div",ke,[e("span",Ie,y(u(a).currentPlaylist.songs.length)+" songs ",1)])])])]),e("div",{class:"px-8 py-6 bg-vibrant-bg"},[e("div",{class:"flex items-center space-x-4"},[e("button",{onClick:$,class:"w-14 h-14 bg-vibrant-pink pixel-border border-vibrant-pink flex items-center justify-center hover:scale-110 transition-transform pixel-texture-vibrant"},[...o[3]||(o[3]=[e("svg",{class:"w-6 h-6 text-white ml-0.5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"})],-1)])]),e("button",{onClick:C,class:"text-gray-600 hover:text-vibrant-pink transition-colors",title:"Delete playlist"},[...o[4]||(o[4]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])])])]),e("div",Pe,[u(a).currentPlaylist.songs.length===0?(i(),l("div",Ae,[...o[5]||(o[5]=[e("p",{class:"text-gray-600 mb-4"},"This playlist is empty",-1),e("p",{class:"text-gray-500 text-sm"},"Add songs from the queue to get started",-1)])])):(i(),S(de,{key:1,songs:u(a).currentPlaylist.songs,"song-data":x.value,"show-remove":!0,onPlay:_,onRemove:P},null,8,["songs","song-data"]))]),q(J)])):w("",!0)])])]))}};export{Be as default};
