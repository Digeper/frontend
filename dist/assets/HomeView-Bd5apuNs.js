import{f as F,u as H,_ as L,a as D,b as O}from"./playlist-D6YYoHEQ.js";import{k as B,c as _,r as $,a as o,o as s,b as e,f as j,n as q,t as y,g,w as T,l as Y,e as I,h as G,m as J,F as Q,p as V,q as K,d as w}from"./index-Czo4c4ru.js";import{usePlayerStore as z}from"./player-BX6ui6XM.js";import{getSongTitle as E,getSongArtist as R,getSongImage as P}from"./songHelpers-TQLMU_GJ.js";import{M as U}from"./Modal-DzNFxRTp.js";const W={class:"w-10 h-10 bg-vibrant-pink-light pixel-border border-vibrant-pink flex items-center justify-center flex-shrink-0 relative overflow-hidden"},X=["src","alt"],Z={class:"absolute inset-0 bg-vibrant-pink bg-opacity-40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"},ee={key:0,class:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},te={key:1,class:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20"},se={key:0,class:"absolute inset-0 pixel-border border-vibrant-pink"},oe={class:"flex-1 min-w-0"},ne={class:"text-gray-600 text-xs truncate"},re={class:"flex items-center space-x-4"},le={class:"text-gray-600 text-sm"},ie=["disabled","title"],ae={__name:"SongItem",props:{song:{type:Object,required:!0},index:{type:Number,default:0}},emits:["add-to-playlist"],setup(x,{emit:l}){const t=x,h=l,n=z(),c=B(),u=_(()=>{var a;return((a=n.currentSong)==null?void 0:a.id)===t.song.id&&n.isPlaying}),f=_(()=>E(t.song)),b=_(()=>R(t.song)),p=_(()=>!c||!Array.isArray(c.songs)?new Set:new Set(c.songs.map(a=>a==null?void 0:a.id).filter(Boolean))),i=_(()=>{var k;if(!((k=t.song)!=null&&k.id))return!1;const a=String(t.song.id);return Array.from(p.value).map(S=>String(S)).includes(a)}),r=$(!1),v=_(()=>r.value?P(null):P(t.song)),m=a=>{r.value=!0,a.target.src=P(null)},C=()=>{u.value?n.togglePlay():n.play(t.song)},A=async()=>{var a;if(i.value){console.log("Song already in queue, skipping add");return}if(!((a=t.song)!=null&&a.id)){console.error("Song does not have an ID:",t.song);return}try{console.log("Adding song to queue:",t.song.id);const d=await c.addSongToQueue(t.song.id,0);d.success?console.log("Song added to queue successfully"):console.error("Failed to add song to queue:",d.error)}catch(d){console.error("Error adding song to queue:",d)}},N=()=>{h("add-to-playlist",t.song)};return(a,d)=>{var k,S,M;return s(),o("div",{class:"flex items-center space-x-4 px-4 py-2 pixel-texture hover:bg-vibrant-bg-hover group cursor-pointer transition-colors",onClick:C},[e("div",W,[e("img",{src:v.value,alt:f.value,class:"w-full h-full object-cover pixelated",onError:m},null,40,X),e("div",Z,[u.value?(s(),o("svg",te,[...d[1]||(d[1]=[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)])])):(s(),o("svg",ee,[...d[0]||(d[0]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"},null,-1)])]))]),u.value?(s(),o("div",se)):j("",!0)]),e("div",oe,[e("p",{class:q(["text-gray-900 font-medium text-sm truncate",{"text-vibrant-pink":u.value}])},y(f.value),3),e("p",ne,y(b.value),1)]),e("div",re,[e("p",le,y(g(F)(x.song.duration)),1),e("button",{onClick:T(A,["stop","prevent"]),disabled:i.value||!((k=t.song)!=null&&k.id),class:q(["transition-opacity",i.value||!((S=t.song)!=null&&S.id)?"opacity-0 group-hover:opacity-40 text-gray-500 cursor-not-allowed pointer-events-none":"opacity-70 group-hover:opacity-100 text-vibrant-purple hover:text-vibrant-pink cursor-pointer"]),title:i.value?"Already in queue":(M=t.song)!=null&&M.id?"Add to queue":"Invalid song",type:"button"},[...d[2]||(d[2]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)])],10,ie),e("button",{onClick:T(N,["stop"]),class:"text-vibrant-purple hover:text-vibrant-pink opacity-0 group-hover:opacity-100 transition-opacity",title:"Add to playlist"},[...d[3]||(d[3]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])])])])}}},de={key:0,class:"text-center py-4"},ce={key:1,class:"text-center py-4"},ue={class:"text-vibrant-pink mb-4"},pe={key:2,class:"text-center py-8"},ge={key:3,class:"bg-red-100 pixel-border border-red-500 p-4 text-red-700 mb-4 pixel-texture"},ve={key:4,class:"text-center py-8"},ye={key:5,class:"max-h-96 overflow-y-auto"},xe={class:"space-y-2"},he=["onClick"],fe={class:"flex items-center space-x-3"},be={class:"flex-1 min-w-0"},me={class:"text-gray-900 font-medium truncate"},_e={key:0,class:"text-gray-600 text-sm truncate"},ke={key:1,class:"text-gray-600 text-sm"},we={__name:"PlaylistSelectionModal",props:{show:{type:Boolean,required:!0},song:{type:Object,default:null}},emits:["close"],setup(x,{emit:l}){const t=x,h=l,n=H(),c=$(null),u=$("");Y(()=>t.show,async i=>{i&&(u.value="",c.value=null,await f())});const f=async()=>{await n.fetchPlaylists()},b=async i=>{var v;if(!((v=t.song)!=null&&v.id))return;if(c.value=i,(await n.addSongToPlaylist(i,t.song.id)).success){const m=n.playlists.find(A=>A.id===i),C=E(t.song);u.value=`"${C}" added to "${(m==null?void 0:m.name)||"playlist"}"`,setTimeout(()=>{p()},2e3)}else c.value=null},p=()=>{u.value="",c.value=null,n.clearError(),h("close")};return(i,r)=>(s(),I(U,{show:x.show,title:"Add to Playlist",onClose:p},{default:G(()=>[c.value?(s(),o("div",de,[...r[0]||(r[0]=[e("p",{class:"text-gray-600"},"Adding song to playlist...",-1)])])):u.value?(s(),o("div",ce,[e("p",ue,y(u.value),1),e("button",{onClick:p,class:"px-4 py-2 bg-vibrant-pink text-white pixel-button border-vibrant-pink font-semibold hover:bg-vibrant-pink-light transition-colors pixel-texture-vibrant"}," Close ")])):g(n).loading?(s(),o("div",pe,[...r[1]||(r[1]=[e("p",{class:"text-gray-600"},"Loading playlists...",-1)])])):g(n).error?(s(),o("div",ge,[J(y(g(n).error)+" ",1),e("button",{onClick:f,class:"mt-2 text-red-700 hover:text-red-900 underline"}," Try again ")])):g(n).playlists.length===0?(s(),o("div",ve,[...r[2]||(r[2]=[e("p",{class:"text-gray-600 mb-4"},"No playlists found",-1),e("p",{class:"text-gray-500 text-sm"},"Create a playlist first to add songs to it",-1)])])):(s(),o("div",ye,[e("div",xe,[(s(!0),o(Q,null,V(g(n).playlists,v=>(s(),o("button",{key:v.id,onClick:m=>b(v.id),class:"w-full text-left px-4 py-3 pixel-border border-transparent hover:border-vibrant-pink hover:bg-vibrant-bg-hover transition-colors group pixel-texture"},[e("div",fe,[r[3]||(r[3]=e("div",{class:"w-12 h-12 bg-gradient-to-br from-vibrant-pink to-vibrant-orange pixel-border border-vibrant-pink flex items-center justify-center flex-shrink-0"},[e("svg",{class:"w-6 h-6 text-white opacity-80",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M18 3a1 1 0 00-1.196-.98l-10 2A1 1 0 006 5v9.114A4.369 4.369 0 005 14c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V7.82l8-1.6v5.894A4.37 4.37 0 0015 12c-1.657 0-3 .895-3 2s1.343 2 3 2 3-.895 3-2V3z"})])],-1)),e("div",be,[e("p",me,y(v.name),1),v.description?(s(),o("p",_e,y(v.description),1)):(s(),o("p",ke,"Playlist"))]),r[4]||(r[4]=e("svg",{class:"w-5 h-5 text-vibrant-purple opacity-0 group-hover:opacity-100 transition-opacity",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1))])],8,he))),128))])]))]),_:1},8,["show"]))}},$e={class:"p-6"},Se={class:"flex items-center justify-between mb-6"},Ce={key:0,class:"text-center py-12"},Ae={key:1,class:"bg-red-100 pixel-border border-red-500 p-4 text-red-700 pixel-texture"},Pe={key:2,class:"text-center py-12"},Me={key:3,class:"space-y-1"},qe={__name:"QueueView",setup(x){const l=B(),t=z(),h=$(!1),n=$(null);K(async()=>{await l.fetchQueue()});const c=()=>{l.songs.length>0&&t.setQueue(l.songs,0,!1)},u=b=>{n.value=b,h.value=!0},f=()=>{h.value=!1,n.value=null};return(b,p)=>(s(),o("div",$e,[e("div",Se,[p[0]||(p[0]=e("h2",{class:"text-2xl font-bold text-gray-900"},"Queue",-1)),g(l).songs.length>0?(s(),o("button",{key:0,onClick:c,class:"px-6 py-2 bg-vibrant-pink text-white pixel-button border-vibrant-pink font-semibold hover:bg-vibrant-pink-light transition-colors pixel-texture-vibrant"}," Play All ")):j("",!0)]),g(l).loading?(s(),o("div",Ce,[...p[1]||(p[1]=[e("p",{class:"text-gray-600"},"Loading queue...",-1)])])):g(l).error?(s(),o("div",Ae,y(g(l).error),1)):g(l).songs.length===0?(s(),o("div",Pe,[...p[2]||(p[2]=[e("p",{class:"text-gray-600 mb-4"},"Your queue is empty",-1),e("p",{class:"text-gray-500 text-sm"},"Add songs to your queue to start playing",-1)])])):(s(),o("div",Me,[(s(!0),o(Q,null,V(g(l).songs,(i,r)=>(s(),I(ae,{key:i.id,song:i,index:r,onAddToPlaylist:u},null,8,["song","index"]))),128))])),w(we,{show:h.value,song:n.value,onClose:f},null,8,["show","song"])]))}},Te={class:"flex h-screen"},Be={class:"flex-1 flex flex-col overflow-hidden"},je={class:"flex-1 overflow-y-auto pb-24"},Ie={class:"p-8"},Qe={class:"mb-8"},He={__name:"HomeView",setup(x){return(l,t)=>(s(),o("div",Te,[w(L),e("div",Be,[w(D),e("div",je,[e("div",Ie,[t[1]||(t[1]=e("h1",{class:"text-3xl font-bold text-gray-900 mb-8"},"Home",-1)),e("div",Qe,[t[0]||(t[0]=e("h2",{class:"text-2xl font-bold text-gray-900 mb-4"},"Queue",-1)),w(qe)])])]),w(O)])]))}};export{He as default};
