import{u as z,b as M,c as w,v as B,o as c,d as p,e,f as _,j as P,n as b,t as v,i as l,h as S,r as k,x as T,y as j,z as V,m as E,s as U,A as F,B as H,C as h,D as g,E as R}from"./index.e515a6fe.js";import{usePlayerStore as I}from"./player.775655bb.js";import{getSongTitle as Y,getSongArtist as N,getSongImage as L}from"./songHelpers.84ed5525.js";const D={class:"w-64 bg-vibrant-purple-light pixel-texture-vibrant h-full flex flex-col border-r-3 border-vibrant-purple"},O={class:"p-6"},K={class:"space-y-2"},Q={class:"mt-auto p-6 border-t-3 border-vibrant-purple pixel-texture-vibrant"},W={class:"flex items-center space-x-3 mb-4"},X={class:"w-10 h-10 bg-vibrant-pink pixel-border border-vibrant-pink flex items-center justify-center"},q={class:"text-white font-bold"},G={class:"flex-1 min-w-0"},J={class:"text-gray-900 font-semibold truncate"},Z={key:0,class:"text-gray-600 text-sm truncate"},zt={__name:"Sidebar",setup(s){const t=z(),a=M(),n=w(()=>{const i=a.username;return i?i.charAt(0).toUpperCase():"U"}),o=()=>{a.logout(),t.push("/login")};return(i,d)=>{var m;const f=B("router-link");return c(),p("aside",D,[e("div",O,[_(f,{to:"/",class:"flex items-center space-x-2 mb-8"},{default:P(()=>[...d[0]||(d[0]=[e("h1",{class:"text-2xl font-bold text-gray-900"},"Digeper",-1)])]),_:1}),e("nav",K,[_(f,{to:"/",class:b(["flex items-center space-x-4 px-4 py-3 pixel-border transition-colors",[i.$route.name==="Home"?"bg-vibrant-pink text-white border-vibrant-pink":"text-gray-700 hover:text-gray-900 hover:bg-vibrant-bg-hover border-transparent"]])},{default:P(()=>[...d[1]||(d[1]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})],-1),e("span",{class:"font-semibold"},"Home",-1)])]),_:1},8,["class"]),_(f,{to:"/playlists",class:b(["flex items-center space-x-4 px-4 py-3 pixel-border transition-colors",[i.$route.name==="Playlists"||i.$route.name==="PlaylistDetail"?"bg-vibrant-pink text-white border-vibrant-pink":"text-gray-700 hover:text-gray-900 hover:bg-vibrant-bg-hover border-transparent"]])},{default:P(()=>[...d[2]||(d[2]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})],-1),e("span",{class:"font-semibold"},"Your Library",-1)])]),_:1},8,["class"])])]),e("div",Q,[e("div",W,[e("div",X,[e("span",q,v(n.value),1)]),e("div",G,[e("p",J,v(l(a).username),1),(m=l(a).user)!=null&&m.email?(c(),p("p",Z,v(l(a).user.email),1)):S("",!0)])]),e("button",{onClick:o,class:"w-full px-4 py-2 bg-vibrant-pink text-white pixel-button border-vibrant-pink hover:bg-vibrant-pink-light transition-colors text-sm font-medium pixel-texture-vibrant"}," Log out ")])])}}},tt={class:"h-16 bg-vibrant-sky-light pixel-texture-vibrant flex items-center justify-between px-6 sticky top-0 z-40 border-b-3 border-vibrant-sky"},et={class:"flex-1 max-w-xl"},rt={class:"relative"},Mt={__name:"TopBar",setup(s){const t=k(""),a=()=>{console.log("Search:",t.value)};return(n,o)=>(c(),p("header",tt,[e("div",et,[e("div",rt,[T(e("input",{type:"text",placeholder:"What do you want to play?",class:"w-full px-4 py-2 pl-10 bg-white text-gray-900 pixel-border border-gray-900 pixel-texture-light focus:outline-none focus:ring-2 focus:ring-vibrant-pink","onUpdate:modelValue":o[0]||(o[0]=i=>t.value=i),onKeyup:V(a,["enter"])},null,544),[[j,t.value]]),o[1]||(o[1]=e("svg",{class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-vibrant-purple",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1))])])]))}};function $(s){if(!s||isNaN(s))return"0:00";const t=Math.floor(s/1e3),a=Math.floor(t/60),n=t%60;return`${a}:${n.toString().padStart(2,"0")}`}const st={class:"fixed bottom-0 left-64 right-0 h-24 bg-vibrant-bg pixel-texture border-t-3 border-vibrant-pink z-50"},lt={class:"flex items-center h-full px-4"},at={class:"flex items-center space-x-4 w-1/4 min-w-[180px]"},ot={key:0,class:"w-14 h-14 bg-vibrant-pink-light pixel-border border-vibrant-pink flex items-center justify-center flex-shrink-0 overflow-hidden"},nt=["src","alt"],it={key:1,class:"min-w-0 flex-1"},ut={class:"text-gray-900 font-medium text-sm truncate"},dt={class:"text-gray-600 text-xs truncate"},ct={class:"flex-1 flex flex-col items-center justify-center space-y-2"},pt={class:"flex items-center space-x-4"},vt=["disabled"],ht=["disabled"],gt={key:0,class:"w-5 h-5 ml-0.5",fill:"currentColor",viewBox:"0 0 20 20"},yt={key:1,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},ft=["disabled"],xt={key:0,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},bt={key:1,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},mt={key:0,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},wt={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},kt={class:"flex items-center space-x-2 w-full max-w-2xl"},_t={class:"text-xs text-gray-600 w-12 text-right"},Pt={class:"text-xs text-gray-600 w-12"},St={class:"flex items-center space-x-2 w-1/4 justify-end"},Lt=["value"],Bt={__name:"PlayerBar",setup(s){const t=I(),a=k(null),n=k(null),o=k(!1);E(()=>{var x;return(x=t.currentSong)==null?void 0:x.id},()=>{o.value=!1});const i=w(()=>Y(t.currentSong)),d=w(()=>N(t.currentSong)),f=w(()=>o.value?L(null):L(t.currentSong)),m=()=>{o.value=!0};U(()=>{a.value&&t.setAudioElement(a.value)}),F(()=>{t.currentObjectUrl&&(URL.revokeObjectURL(t.currentObjectUrl),t.currentObjectUrl=null)});const A=x=>{if(!n.value||!t.duration)return;const r=n.value.getBoundingClientRect(),C=(x.clientX-r.left)/r.width*t.duration;t.seekTo(C)};return(x,r)=>(c(),p("div",st,[e("div",lt,[e("div",at,[l(t).currentSong?(c(),p("div",ot,[e("img",{src:f.value,alt:i.value,class:"w-full h-full object-cover pixelated",onError:m},null,40,nt)])):S("",!0),l(t).currentSong?(c(),p("div",it,[e("p",ut,v(i.value),1),e("p",dt,v(d.value),1)])):S("",!0)]),e("div",ct,[e("div",pt,[e("button",{onClick:r[0]||(r[0]=(...u)=>l(t).toggleShuffle&&l(t).toggleShuffle(...u)),class:b(["text-gray-600 hover:text-vibrant-pink transition-colors",{"text-vibrant-pink":l(t).shuffle}])},[...r[8]||(r[8]=[e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})],-1)])],2),e("button",{onClick:r[1]||(r[1]=(...u)=>l(t).previous&&l(t).previous(...u)),disabled:!l(t).hasPrevious&&!l(t).repeat,class:"text-gray-900 hover:text-vibrant-pink transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[...r[9]||(r[9]=[e("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M8.445 14.832A1 1 0 0010 14v-2.798l5.445 3.63A1 1 0 0017 14V6a1 1 0 00-1.555-.832L10 8.798V6a1 1 0 00-1.555-.832l-6 4a1 1 0 000 1.664l6 4z"})],-1)])],8,vt),e("button",{onClick:r[2]||(r[2]=(...u)=>l(t).togglePlay&&l(t).togglePlay(...u)),class:"w-10 h-10 bg-vibrant-pink text-white pixel-border border-vibrant-pink flex items-center justify-center hover:scale-110 transition-transform pixel-texture-vibrant",disabled:!l(t).currentSong},[l(t).isPlaying?(c(),p("svg",yt,[...r[11]||(r[11]=[e("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)])])):(c(),p("svg",gt,[...r[10]||(r[10]=[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z","clip-rule":"evenodd"},null,-1)])]))],8,ht),e("button",{onClick:r[3]||(r[3]=(...u)=>l(t).next&&l(t).next(...u)),disabled:!l(t).hasNext&&!l(t).repeat,class:"text-gray-900 hover:text-vibrant-pink transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[...r[12]||(r[12]=[e("svg",{class:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M11.555 5.168A1 1 0 0010 6v2.798L4.555 5.168A1 1 0 003 6v8a1 1 0 001.555.832L10 11.202V14a1 1 0 001.555.832l6-4a1 1 0 000-1.664l-6-4z"})],-1)])],8,ft),e("button",{onClick:r[4]||(r[4]=(...u)=>l(t).toggleRepeat&&l(t).toggleRepeat(...u)),class:b(["text-gray-600 hover:text-vibrant-pink transition-colors",{"text-vibrant-pink":l(t).repeat==="all","text-vibrant-pink":l(t).repeat==="one"}])},[l(t).repeat==="one"?(c(),p("svg",xt,[...r[13]||(r[13]=[e("path",{"fill-rule":"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z","clip-rule":"evenodd"},null,-1),e("circle",{cx:"10",cy:"10",r:"1",fill:"currentColor"},null,-1)])])):(c(),p("svg",bt,[...r[14]||(r[14]=[e("path",{"fill-rule":"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z","clip-rule":"evenodd"},null,-1)])]))],2),e("button",{onClick:r[5]||(r[5]=(...u)=>l(t).toggleLiked&&l(t).toggleLiked(...u)),class:b(["text-gray-400 hover:text-white transition-colors",{"text-red-500 hover:text-red-400":l(t).isLiked,"text-gray-400 hover:text-white":!l(t).isLiked}]),title:"Like song"},[l(t).isLiked?(c(),p("svg",mt,[...r[15]||(r[15]=[e("path",{"fill-rule":"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z","clip-rule":"evenodd"},null,-1)])])):(c(),p("svg",wt,[...r[16]||(r[16]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"},null,-1)])]))],2)]),e("div",kt,[e("span",_t,v(l($)(l(t).currentTime)),1),e("div",{class:"flex-1 h-1 bg-gray-300 rounded-full cursor-pointer group",onClick:A,ref_key:"progressBarRef",ref:n},[e("div",{class:"h-full bg-vibrant-pink rounded-full transition-all group-hover:bg-vibrant-pink-light relative",style:H({width:`${l(t).progress}%`})},[...r[17]||(r[17]=[e("div",{class:"w-3 h-3 bg-vibrant-pink rounded-full opacity-0 group-hover:opacity-100 absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-1/2"},null,-1)])],4)],512),e("span",Pt,v(l($)(l(t).duration)),1)])]),e("div",St,[r[18]||(r[18]=e("svg",{class:"w-5 h-5 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.383 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.383l4-3.793a1 1 0 011.617.793zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 12a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 12c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 12a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 12a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z","clip-rule":"evenodd"})],-1)),e("input",{type:"range",min:"0",max:"1",step:"0.01",value:l(t).volume,onInput:r[6]||(r[6]=u=>l(t).setVolume(u.target.value)),class:"w-24 h-1 bg-gray-300 rounded-lg appearance-none cursor-pointer accent-vibrant-pink"},null,40,Lt)])]),e("audio",{ref_key:"audioElement",ref:a,preload:"metadata",onLoadedmetadata:r[7]||(r[7]=u=>l(t).setAudioElement(u.target))},null,544)]))}},y={async getAllPlaylists(){return(await h.get(`${g.PLAYLIST}/playlist`)).data},async getPlaylist(s){return(await h.get(`${g.PLAYLIST}/playlist/${s}`)).data},async createPlaylist(s,t=null){return(await h.post(`${g.PLAYLIST}/playlist`,{name:s,description:t})).data},async deletePlaylist(s){await h.delete(`${g.PLAYLIST}/playlist/${s}`)},async addSongToPlaylist(s,t){await h.post(`${g.PLAYLIST}/playlist/${s}/song/${t}`)},async removeSongFromPlaylist(s,t){await h.delete(`${g.PLAYLIST}/playlist/${s}/song/${t}`)}},Tt=R("playlist",{state:()=>({playlists:[],currentPlaylist:null,loading:!1,error:null}),getters:{playlistCount:s=>s.playlists.length},actions:{async fetchPlaylists(){var s,t;this.loading=!0,this.error=null;try{return this.playlists=await y.getAllPlaylists(),{success:!0}}catch(a){return this.error=((t=(s=a.response)==null?void 0:s.data)==null?void 0:t.error)||a.message||"Failed to fetch playlists",{success:!1,error:this.error}}finally{this.loading=!1}},async fetchPlaylist(s){var t,a;this.loading=!0,this.error=null;try{return this.currentPlaylist=await y.getPlaylist(s),{success:!0,data:this.currentPlaylist}}catch(n){return this.error=((a=(t=n.response)==null?void 0:t.data)==null?void 0:a.error)||n.message||"Failed to fetch playlist",{success:!1,error:this.error}}finally{this.loading=!1}},async createPlaylist(s,t=null){var a,n;this.loading=!0,this.error=null;try{const o=await y.createPlaylist(s,t);return this.playlists.push(o),{success:!0,data:o}}catch(o){return this.error=((n=(a=o.response)==null?void 0:a.data)==null?void 0:n.error)||o.message||"Failed to create playlist",{success:!1,error:this.error}}finally{this.loading=!1}},async deletePlaylist(s){var t,a,n,o;this.loading=!0,this.error=null;try{return await y.deletePlaylist(s),this.playlists=this.playlists.filter(i=>i.id!==s),((a=(t=this.currentPlaylist)==null?void 0:t.playlist)==null?void 0:a.id)===s&&(this.currentPlaylist=null),{success:!0}}catch(i){return this.error=((o=(n=i.response)==null?void 0:n.data)==null?void 0:o.error)||i.message||"Failed to delete playlist",{success:!1,error:this.error}}finally{this.loading=!1}},async addSongToPlaylist(s,t){var a,n,o,i;this.loading=!0,this.error=null;try{return await y.addSongToPlaylist(s,t),((n=(a=this.currentPlaylist)==null?void 0:a.playlist)==null?void 0:n.id)===s&&await this.fetchPlaylist(s),{success:!0}}catch(d){return this.error=((i=(o=d.response)==null?void 0:o.data)==null?void 0:i.error)||d.message||"Failed to add song to playlist",{success:!1,error:this.error}}finally{this.loading=!1}},async removeSongFromPlaylist(s,t){var a,n,o,i;this.loading=!0,this.error=null;try{return await y.removeSongFromPlaylist(s,t),((n=(a=this.currentPlaylist)==null?void 0:a.playlist)==null?void 0:n.id)===s&&await this.fetchPlaylist(s),{success:!0}}catch(d){return this.error=((i=(o=d.response)==null?void 0:o.data)==null?void 0:i.error)||d.message||"Failed to remove song from playlist",{success:!1,error:this.error}}finally{this.loading=!1}},clearCurrentPlaylist(){this.currentPlaylist=null},clearError(){this.error=null}}});export{zt as _,Mt as a,Bt as b,$ as f,Tt as u};
